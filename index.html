<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Pixel Editor</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root { --scale: 8; }
    body { background:#121212; color:#eaeaea; font-family:sans-serif; margin:0; padding:20px; }
    h1 { text-align:center; }
    .toolbar { display:flex; gap:12px; justify-content:center; margin-bottom:12px; flex-wrap:wrap; }
    #canvasWrapper {
      margin:0 auto;
      border:2px solid #333;
      background:#1a1a1a;
      width:512px; /* wird per JS überschrieben */
      height:512px;
    }
    canvas {
      width:100%;
      height:100%;
      image-rendering:pixelated;
      display:block;
    }
  </style>
</head>
<body>
  <h1>Pixel Editor</h1>
  <div class="toolbar">
    <label>Resolution
      <select id="resolution">
        <option value="64">64×64</option>
        <option value="42">42×42</option>
        <option value="32">32×32</option>
        <option value="16">16×16</option>
      </select>
    </label>
    <label>Farbe <input type="color" id="color" value="#ff4d4d"></label>
    <label>Zoom <input type="range" id="scale" min="4" max="16" value="8"></label>
    <label>Werkzeug
      <select id="tool">
        <option value="pen">Stift</option>
        <option value="eraser">Radierer</option>
      </select>
    </label>
    <button id="clear">Leeren</button>
    <button id="download">Download</button>
  </div>

  <div id="canvasWrapper">
    <canvas id="canvas"></canvas>
  </div>

  <script>
    const canvas=document.getElementById('canvas');
    const ctx=canvas.getContext('2d',{willReadFrequently:true});
    const resolutionSelect=document.getElementById('resolution');
    const scale=document.getElementById('scale');
    const clearBtn=document.getElementById('clear');
    const downloadBtn=document.getElementById('download');
    const color=document.getElementById('color');
    const toolSelect=document.getElementById('tool');
    let drawing=false;

    // Canvas Setup
    function setupCanvas(size){
      canvas.width=size;
      canvas.height=size;
      document.getElementById('canvasWrapper').style.width=(size*scale.value)+"px";
      document.getElementById('canvasWrapper').style.height=(size*scale.value)+"px";
      ctx.clearRect(0,0,size,size);
    }
    setupCanvas(64);

    // Umschalten über Dropdown
    resolutionSelect.addEventListener('change',()=>{
      setupCanvas(parseInt(resolutionSelect.value));
    });

    // Pixelberechnung
    function getPixel(e){
      const rect=canvas.getBoundingClientRect();
      const x=Math.floor((e.clientX-rect.left)*canvas.width/rect.width);
      const y=Math.floor((e.clientY-rect.top)*canvas.height/rect.height);
      return {x,y};
    }

    // Zeichnen / Radieren
    function paint(x
